{% extends "jobs/base.html" %}
{% block content %}
<div class="max-w-4xl mx-auto bg-white shadow-lg rounded-2xl p-8 mt-10 border border-gray-100">
    <h1 class="text-2xl font-bold text-gray-800 mb-3">üìÑ Your Resume</h1>
    <p class="text-gray-600 mb-4">
        Uploaded on: {{ resume.uploaded_at|date:"F j, Y, g:i a" }}
    </p>

    <!-- ‚úÖ Embed PDF with fallback -->
    <div class="border rounded-lg overflow-hidden" style="height: 700px;">
        <iframe 
            id="resumeViewer"
            src="{{ resume.file.url }}" 
            width="100%" 
            height="100%" 
            frameborder="0">
        </iframe>

        <!-- Fallback message -->
        <div id="fallbackMessage" class="hidden text-center p-6 text-gray-600">
            <p>‚ö†Ô∏è Unable to display PDF in your browser.</p>
            <p>
                <a href="{{ resume.file.url }}" target="_blank" class="text-indigo-600 font-semibold underline">
                    Click here to open your resume
                </a>
            </p>
        </div>
    </div>

    <!-- ‚úÖ Download Button -->
    <div class="mt-6 text-center">
        <a href="{{ resume.file.url }}" 
           download 
           class="px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-black transition">
            ‚¨áÔ∏è Download Resume
        </a>
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
    const iframe = document.getElementById("resumeViewer");
    const fallback = document.getElementById("fallbackMessage");

    iframe.addEventListener("error", () => {
        iframe.classList.add("hidden");
        fallback.classList.remove("hidden");
    });

    // Optional: hide iframe if Chrome blocks local embed
    setTimeout(() => {
        if (iframe.contentDocument === null) {
            iframe.classList.add("hidden");
            fallback.classList.remove("hidden");
        }
    }, 1000);
});
</script>
{% endblock %}
